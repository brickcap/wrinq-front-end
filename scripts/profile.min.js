function autoGrow(e){e.scrollHeight>e.clientHeight&&(e.style.height=e.scrollHeight+"px")}function createImage(e){preview.innerHTML="",e.autoLink({callback:function(e){return/\.(gif|png|jpe?g)$/i.test(e)?addImage(e):null}})}function addImage(e){preview.innerHTML='<img id ="profileimage" src="'+e+'">',userName.focus()}function getStore(e,t){var n=database.transaction([e],t),r=n.objectStore(e);return r}function updateProfile(){notification.innerHTML="";var e=getStore("profile","readwrite"),t=document.getElementById("profileimage"),n={pic:t?t.src:"",about:about.value,name:userName.value,upgraded:!0},r=e.put(n,"master");r.onsuccess=function(){notification.innerHTML="Profile saved"},r.onerror=function(e){notification.innerHTML="Could not save profile"}}(function(){var e,t=[].slice;e=function(){var e,n,r,i,s,o;return i=1<=arguments.length?t.call(arguments,0):[],s=/(^|\s)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,i.length>0?(r=i[0],n=function(){var t;t=[];for(e in r)o=r[e],e!=="callback"&&t.push(" "+e+"='"+o+"'");return t}().join(""),this.replace(s,function(e,t,i){var s;return s=(typeof r.callback=="function"?r.callback(i):void 0)||"<a href='"+i+"'"+n+">"+i+"</a>",""+t+s})):this.replace(s,"$1<a href='$2'>$2</a>")},String.prototype.autoLink=e}).call(this);var preview=document.getElementById("imagepreview"),userName=document.getElementById("name"),profilePic=document.getElementById("profilepic"),about=document.getElementById("abouttext"),notification=document.getElementById("notification"),openRequest=indexedDB.open("wrinq",1),database;openRequest.onsuccess=function(e){database=e.target.result;var t=getStore("profile","readonly"),n=t.get("master");n.onsuccess=function(e){var t=e.target.result;document.getElementsByTagName("body")[0].style.display="block";if(!t)return;profilePic.value=t.pic,userName.value=t.name,about.value=t.about,profilePic.value&&addImage(profilePic.value)}}